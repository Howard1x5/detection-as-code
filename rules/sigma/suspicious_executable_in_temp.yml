title: Suspicious Executable Created in Temp Directory
id: 7c8d9e0f-2b4a-5c6d-7e8f-901234567890
status: experimental
description: Detects creation of executable files in temporary directories, a common malware staging technique
author: Detection Pipeline Project
date: 2026/02/04
references:
    - https://attack.mitre.org/techniques/T1204/002/
logsource:
    category: file_event
    product: windows
detection:
    selection:
        TargetFilename|contains:
            - '\AppData\Local\Temp\'
            - '\Windows\Temp\'
            - '\Users\Public\'
        TargetFilename|endswith:
            - '.exe'
            - '.dll'
            - '.scr'
            - '.bat'
            - '.cmd'
            - '.ps1'
            - '.vbs'
            - '.js'
    filter_legitimate:
        Image|contains:
            - '\Windows\System32\'
            - '\Program Files\'
            - '\Windows\SysWOW64\'
    condition: selection and not filter_legitimate
falsepositives:
    - Software installers
    - Legitimate update mechanisms
level: medium
tags:
    - attack.defense_evasion
    - attack.t1204.002
    - attack.execution
